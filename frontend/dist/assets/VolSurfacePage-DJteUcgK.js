import{a,j as e}from"./vendor-react-Bde5w1iN.js";import{s as y,T as R}from"./search-BXjqKZLA.js";import{B as U,t as l}from"./index-BajzrNI3.js";import{C,b as v,c as N,a as b}from"./card-mz1ygTyE.js";import{L as c}from"./label-sTsobr-L.js";import{S as o,a as d,b as h,c as x,d as u}from"./select-DfeukBJp.js";import{C as X}from"./checkbox-CCjkJiTi.js";import{L as B}from"./vendor-icons-Do0RMBwc.js";import{R as G,h as H,C as I,X as K,Y,T as _,L as z,j as J}from"./vendor-charts-DMFZZfud.js";import"./vendor-router-BFkrKKjM.js";import"./vendor-radix-DxOrs8Le.js";const M=["NFO","BFO","MCX","CDS"],k=["#3b82f6","#22c55e","#ef4444","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#84cc16"];function ne(){const[i,E]=a.useState("NFO"),[r,L]=a.useState(""),[V,T]=a.useState([]),[m,F]=a.useState([]),[n,j]=a.useState([]),[f,O]=a.useState("15"),[p,g]=a.useState(!1),[S,w]=a.useState([]);a.useEffect(()=>{i&&y.getUnderlyings(i).then(s=>{s.status==="success"&&T(s.underlyings||[])})},[i]),a.useEffect(()=>{i&&r&&y.getExpiries(i,r).then(s=>{s.status==="success"&&(F(s.expiries||[]),j([]))})},[i,r]);const A=s=>{j(t=>t.includes(s)?t.filter(P=>P!==s):[...t,s].slice(0,8))},D=async()=>{if(!r||n.length===0){l.error("Please select underlying and at least one expiry");return}g(!0);try{const t=await(await fetch("/volsurface/api/surface-data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({underlying:r,exchange:i,expiry_dates:n,strike_count:parseInt(f)})})).json();t.status==="success"?w(t.data||[]):l.error(t.message||"Failed to fetch vol surface data")}catch{l.error("Failed to fetch vol surface data")}finally{g(!1)}};return e.jsxs(R,{title:"Vol Surface",description:"Volatility surface visualization across strikes and expiries",children:[e.jsxs(C,{className:"mb-6",children:[e.jsx(v,{children:e.jsx(N,{children:"Select Parameters"})}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Exchange"}),e.jsxs(o,{value:i,onValueChange:E,children:[e.jsx(d,{children:e.jsx(h,{})}),e.jsx(x,{children:M.map(s=>e.jsx(u,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Underlying"}),e.jsxs(o,{value:r,onValueChange:L,children:[e.jsx(d,{children:e.jsx(h,{placeholder:"Select underlying"})}),e.jsx(x,{children:V.map(s=>e.jsx(u,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Strike Count"}),e.jsxs(o,{value:f,onValueChange:O,children:[e.jsx(d,{children:e.jsx(h,{})}),e.jsx(x,{children:[10,15,20,25,30,40].map(s=>e.jsxs(u,{value:s.toString(),children:[s," strikes"]},s))})]})]})]}),m.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Select Expiries (max 8)"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:m.slice(0,12).map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{id:s,checked:n.includes(s),onCheckedChange:()=>A(s),disabled:!n.includes(s)&&n.length>=8}),e.jsx("label",{htmlFor:s,className:"text-sm cursor-pointer",children:s})]},s))})]}),e.jsxs(U,{onClick:D,disabled:p,children:[p&&e.jsx(B,{className:"mr-2 h-4 w-4 animate-spin"}),"Fetch Vol Surface"]})]})]}),S.length>0&&e.jsxs(C,{children:[e.jsx(v,{children:e.jsx(N,{children:"Volatility Surface"})}),e.jsx(b,{children:e.jsx("div",{className:"h-[500px]",children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(H,{data:S,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(I,{strokeDasharray:"3 3"}),e.jsx(K,{dataKey:"strike"}),e.jsx(Y,{domain:["auto","auto"]}),e.jsx(_,{}),e.jsx(z,{}),n.map((s,t)=>e.jsx(J,{type:"monotone",dataKey:s,name:s,stroke:k[t%k.length],strokeWidth:2},s))]})})})})]})]})}export{ne as default};
