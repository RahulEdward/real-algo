import{a as s,j as e}from"./vendor-react-Bde5w1iN.js";import{T as B}from"./search-BXjqKZLA.js";import{U as D}from"./UnderlyingSelector-DjoW0y42.js";import{B as w,t as l}from"./index-BajzrNI3.js";import{C as p,b as j,c as y,a as f}from"./card-mz1ygTyE.js";import{L as u}from"./label-sTsobr-L.js";import{S as g,a as C,b as S,c as v,d as t}from"./select-DfeukBJp.js";import{L as F}from"./vendor-icons-Do0RMBwc.js";import{R as U,B as k,C as K,X as R,Y as V,T as _,L as A,f as I}from"./vendor-charts-DMFZZfud.js";import"./vendor-router-BFkrKKjM.js";import"./vendor-radix-DxOrs8Le.js";function $(){const[o,O]=s.useState("NFO"),[r,b]=s.useState(""),[i,N]=s.useState(""),[c,P]=s.useState("5m"),[d,L]=s.useState("5"),[x,h]=s.useState(!1),[m,T]=s.useState([]),E=async()=>{if(!r||!i){l.error("Please select underlying and expiry");return}h(!0);try{const n=await(await fetch("/oiprofile/api/profile-data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({underlying:r,exchange:o,expiry_date:i,interval:c,days:parseInt(d)})})).json();n.status==="success"?T(n.data||[]):l.error(n.message||"Failed to fetch OI profile data")}catch{l.error("Failed to fetch OI profile data")}finally{h(!1)}};return e.jsxs(B,{title:"OI Profile",description:"Open interest distribution analysis over time",children:[e.jsxs(p,{className:"mb-6",children:[e.jsx(j,{children:e.jsx(y,{children:"Select Parameters"})}),e.jsxs(f,{className:"space-y-4",children:[e.jsx(D,{exchange:o,underlying:r,expiry:i,onExchangeChange:O,onUnderlyingChange:b,onExpiryChange:N}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Interval"}),e.jsxs(g,{value:c,onValueChange:P,children:[e.jsx(C,{children:e.jsx(S,{})}),e.jsxs(v,{children:[e.jsx(t,{value:"1m",children:"1m"}),e.jsx(t,{value:"5m",children:"5m"}),e.jsx(t,{value:"15m",children:"15m"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Days"}),e.jsxs(g,{value:d,onValueChange:L,children:[e.jsx(C,{children:e.jsx(S,{})}),e.jsx(v,{children:[1,3,5,7,10,15,30].map(a=>e.jsxs(t,{value:a.toString(),children:[a," ",a===1?"day":"days"]},a))})]})]})]}),e.jsxs(w,{onClick:E,disabled:x,children:[x&&e.jsx(F,{className:"mr-2 h-4 w-4 animate-spin"}),"Fetch OI Profile"]})]})]}),m.length>0&&e.jsxs(p,{children:[e.jsx(j,{children:e.jsx(y,{children:"Open Interest Profile"})}),e.jsx(f,{children:e.jsx("div",{className:"h-[500px]",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(k,{data:m,layout:"vertical",margin:{top:20,right:30,left:60,bottom:5},children:[e.jsx(K,{strokeDasharray:"3 3"}),e.jsx(R,{type:"number"}),e.jsx(V,{dataKey:"strike",type:"category"}),e.jsx(_,{}),e.jsx(A,{}),e.jsx(I,{dataKey:"call_oi",name:"Call OI",fill:"#22c55e"}),e.jsx(I,{dataKey:"put_oi",name:"Put OI",fill:"#ef4444"})]})})})})]})]})}export{$ as default};
